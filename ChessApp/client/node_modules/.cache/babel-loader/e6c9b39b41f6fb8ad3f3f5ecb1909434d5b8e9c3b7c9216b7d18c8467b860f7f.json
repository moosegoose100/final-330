{"ast":null,"code":"/*\n * WebChess\n * @features for client: realtime, turn-based, single device (2player), multitouch, etc.\n */\nvar Board = require('./board.js');\nvar Rules = require('./rules.js');\nvar Piece = require('./piece.js');\nvar Move = require('./move.js');\nfunction Game() {\n  this.rules = new Rules();\n  this.started = new Date();\n  this.ended = '';\n  this.moves = [];\n  this.board = new Board(this.rules.TILES_X, this.rules.TILES_Y);\n  this.turn = this.rules.STARTING_PLAYER;\n  this.enPassant = null;\n  this.setupGame(this.rules);\n}\n;\nGame.prototype.setupGame = function (rules) {\n  var game = this;\n  for (var i = 0; i < rules.START_POSITIONS.length; ++i) {\n    var tile = game.board.getTile(rules.START_POSITIONS[i]['position']['x'], rules.START_POSITIONS[i]['position']['y']);\n    tile.piece = new Piece(rules.START_POSITIONS[i]['type'], rules.START_POSITIONS[i]['colour']);\n  }\n};\nGame.prototype.move = function (from, to) {\n  var result = {};\n  var fromTile = this.board.getTile(from['x'], from['y']);\n  var toTile = this.board.getTile(to['x'], to['y']);\n  var validatedMove = this.rules.validateMove(this, fromTile, toTile);\n  if (validatedMove) {\n    result.code = 1;\n    result.msg = \"Move executed\";\n    result.move = validatedMove.execute(this);\n    this.moves.push(result.move);\n    this.changeTurn();\n  } else {\n    result.code = 0;\n    result.msg = \"Move not executed\";\n  }\n  return result;\n};\nGame.prototype.changeTurn = function () {\n  this.turn = this.turn === this.rules.WHITE ? this.rules.BLACK : this.rules.WHITE;\n};\nGame.prototype.getState = function (format) {\n  var result = '';\n  switch (format) {\n    case \"ascii\":\n      result = this.printAscii();\n      break;\n    case \"json\":\n    default:\n      result = JSON.stringify(this.board);\n      break;\n  }\n  return result;\n};\nGame.prototype.printAscii = function () {\n  var tiles = this.board.tiles;\n  var stringboard = ['--------'];\n  var i = 9;\n  while (--i > 0) {\n    var row = [];\n    var j = 0;\n    while (j++ < 8) {\n      var tile = this.board.getTile(j, i);\n      if (tile.piece) {\n        var type = tile.piece.type.substring(0, 1);\n        row.push(type);\n      } else {\n        row.push('.');\n      }\n    }\n    stringboard.push(row.join(''));\n  }\n  stringboard.push('--------');\n  return stringboard.join('\\n');\n};\nmodule.exports = Game;","map":{"version":3,"names":["Board","require","Rules","Piece","Move","Game","rules","started","Date","ended","moves","board","TILES_X","TILES_Y","turn","STARTING_PLAYER","enPassant","setupGame","prototype","game","i","START_POSITIONS","length","tile","getTile","piece","move","from","to","result","fromTile","toTile","validatedMove","validateMove","code","msg","execute","push","changeTurn","WHITE","BLACK","getState","format","printAscii","JSON","stringify","tiles","stringboard","row","j","type","substring","join","module","exports"],"sources":["Z:/IGMProfile/Desktop/final-330/ChessApp/node_modules/chessjs/lib/game.js"],"sourcesContent":["/*\n * WebChess\n * @features for client: realtime, turn-based, single device (2player), multitouch, etc.\n */\nvar Board = require('./board.js');\nvar Rules = require('./rules.js');\nvar Piece = require('./piece.js');\nvar Move = require('./move.js');\n\nfunction Game() {\n  this.rules = new Rules();\n  this.started = new Date();\n  this.ended = '';\n  \n  this.moves = [];\n  this.board = new Board(this.rules.TILES_X, this.rules.TILES_Y);\n  this.turn = this.rules.STARTING_PLAYER;\n  \n  this.enPassant = null;\n  this.setupGame(this.rules);\n};\n\nGame.prototype.setupGame = function (rules) {\n  var game = this;\n  for (var i = 0; i < rules.START_POSITIONS.length; ++i) {\n    var tile = game.board.getTile(rules.START_POSITIONS[i]['position']['x'], rules.START_POSITIONS[i]['position']['y']);\n    tile.piece = new Piece(rules.START_POSITIONS[i]['type'], rules.START_POSITIONS[i]['colour']);\n  }\n};\n\nGame.prototype.move = function (from, to) {\n  var result = {};\n\n  var fromTile = this.board.getTile(from['x'], from['y']);\n  var toTile = this.board.getTile(to['x'], to['y']);\n\n  var validatedMove = this.rules.validateMove(this, fromTile, toTile);\n  if (validatedMove) {\n    result.code = 1;\n    result.msg = \"Move executed\";\n    result.move = validatedMove.execute(this);\n    this.moves.push(result.move);\n    this.changeTurn();\n  } else {\n    result.code = 0;\n    result.msg = \"Move not executed\";\n  }\n  return result;\n}\n\nGame.prototype.changeTurn = function () {\n  this.turn = this.turn === this.rules.WHITE ? this.rules.BLACK : this.rules.WHITE;\n}\n\nGame.prototype.getState = function (format) {\n  var result = '';\n  switch (format) {\n    case \"ascii\":\n      result = this.printAscii();\n      break;\n    case \"json\":\n    default:\n      result = JSON.stringify(this.board);\n      break;\n  }\n  return result;\n}\n\nGame.prototype.printAscii = function () {\n  var tiles = this.board.tiles;\n\n  var stringboard = ['--------'];\n  var i = 9;\n  while (--i>0) {\n    var row = [];\n    var j = 0;\n    while (j++<8) {\n      var tile = this.board.getTile(j, i);\n      if (tile.piece) {\n        var type = tile.piece.type.substring(0,1);\n        row.push(type);\n      } else {\n        row.push('.');\n      }\n    }\n    stringboard.push(row.join(''));\n  }\n  stringboard.push('--------');\n\n  return stringboard.join('\\n');\n}\n                    \nmodule.exports = Game;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}